<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>OAuth Redirect - Vaccination MAUI</title>
  <!-- Add 'android' class early to avoid UI flash on Android -->
  <script>if (/Android/i.test(navigator.userAgent)) { document.documentElement.classList.add('android'); }</script>
  <style>
    body { font-family: Arial, sans-serif; text-align:center; padding:50px; background:#f5f5f5; margin:0 }
    .container { background:#fff; padding:30px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1); max-width:500px; margin:40px auto }
    .success { color:#28a745; font-size:24px; margin-bottom:20px }
    .message { color:#666; margin-bottom:20px }
    .btn { background:#007bff; color:#fff; border:0; padding:10px 20px; border-radius:5px; cursor:pointer; font-size:16px; margin:5px }
    .btn:hover { background:#0056b3 }
    /* Hide only on Android to avoid UI flash there */
    html.android body { display:none }
  </style>
  <script>
    (function () {
      var params = window.location.search || "";
      var deepLink = "vaccinationmaui://oauth2redirect" + params;
      var isAndroid = document.documentElement.classList.contains("android");

      if (isAndroid) {
        // ANDROID: redirect immediately, no flash
        window.location.replace(deepLink);
        // Fallback if app doesn't open quickly
        setTimeout(function () {
          document.documentElement.classList.remove("android");
          document.body.innerHTML =
            "<div class='container'><div class='message'>If your app did not open, please install it and try again.</div></div>";
        }, 1200);
      } else {
        // WINDOWS/others: show UI and also attempt deep link
        window.addEventListener("DOMContentLoaded", function () {
          document.getElementById("returnBtn").onclick = function () { window.location.href = deepLink; };
          // Auto-attempt deep link after a short delay
          setTimeout(function () { window.location.href = deepLink; }, 300);
        });
      }
    })();
  </script>
</head>
<body>
  <div class="container">
    <div class="success">âœ… Authentication Successful!</div>
    <div class="message">You have successfully signed in with Google.<br>Click the button below to return to your app.</div>
    <button class="btn" id="returnBtn">Return to App</button>
  </div>
</body>
</html>
